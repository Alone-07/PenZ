
<ion-header [translucent]="true" class="custom-header">
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-back-button defaultHref="" icon="arrow-back-circle" class="custom-back-button" (click)="goBack()"></ion-back-button>
            <!-- <ion-icon name="arrow-back-circle" class="custom-back-button"></ion-icon> -->
        </ion-buttons>
        <ion-title class="header-title">
            Add a Goal
        </ion-title>
    </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" >
    <section class="goal-bar-container">
        <div class="bar-container" [class.bar-container-active]="isGoalDetailsFilled">
            <p class="goal-no goal-no-active">
                <span *ngIf="!isGoalDetailsFilled">1</span>
                <img src="../../assets/icon/success.svg" alt="success" *ngIf="isGoalDetailsFilled">
            </p>
            <progress [value]="progressValue" max="100"></progress>
            <p class="goal-no" [class.goal-no-active]="isGoalDetailsFilled">2</p>
        </div>
    </section>
    <div class="goals-bg" [class.d-none]="showSecondPage">  
        <ion-grid class="goals-filter">
            <ion-row class="goals-select">
                <ion-col size="12">
                    <h1 class="title">Category</h1>  
                    <div class="select-container">
                        <ion-chip *ngFor="let category of categories" (click)="toggleCategorySelection(category.subCategoryId)" [class.selected]="category.isActive == 'Y'" class="select_option">
                            {{ category.subCategoryName }}
                        </ion-chip>
                    </div>
                </ion-col>
            </ion-row>
            <ng-content *ngFor="let question of selectedCategory.questions; let questionId = index;">
                <ion-row class="goals-select">
                    <ion-col size="12">
                        <h1 class="title">{{question.question}}</h1>  
                        <div class="select-container">
                            <ion-chip *ngFor="let option of question.options; let optionId = index;" (click)="toggleQuestionSelection(questionId, optionId)" [class.selected]="question.selectedOption == option.id" class="select_option">
                                {{ option.option_value }}
                            </ion-chip>
                        </div>
                    </ion-col>
                </ion-row>
            </ng-content>
        </ion-grid>
    </div>

    <div class="goals-bg target-header" [class.d-none]="!showSecondPage"> 
        <ion-grid>
            <ion-row class="target-head">
                <ion-col size="12">
                    <h2 class="title">Define your Goal</h2>
                    <ion-input label="My Skin Care - Goal" label-placement="floating" fill="outline" placeholder="My Skin Care - Goal" class="goal-input"></ion-input>
                </ion-col>
            </ion-row>
            <ion-row class="">
                <ion-col size="12">
                    <h2 class="title subtitle">Target Date</h2>
                    <ion-datetime 
                        locale="en-GB"
                        hourCycle="h12"
                        presentation="date"
                        preferWheel="false"
                        [value]="selectedDate"
                        (ionChange)="handleDateChange($event)">
                    </ion-datetime>
                </ion-col>
            </ion-row>
            <ion-row class="">
                <ion-col size="12">
                    <h2 class="title subtitle">Progress Tracker</h2>
                    <progress value="50" max="100"> </progress>
                    <div class="prog_range">
                        <p>78 days left</p>
                        <p>120 Days</p>
                    </div>
                </ion-col>
            </ion-row>
        </ion-grid>
    </div>
</ion-content>


<ion-footer>
    <ion-toolbar [class.d-none]="showSecondPage">
        <ion-buttons slot="start">
            <ion-button (click)="onCancel()" class="cancel-button">Cancel</ion-button>
        </ion-buttons>
        <ion-buttons slot="end">
            <ion-button (click)="onContinue()" class="continue-button">Continue</ion-button>
        </ion-buttons>
    </ion-toolbar>

    <ion-toolbar [class.d-none]="!showSecondPage">
        <ion-buttons slot="start">
            <ion-button (click)="onCancel()"  class="cancel-button">Back</ion-button>
        </ion-buttons>
        <ion-buttons slot="end">
            <ion-button class="continue-button">Save</ion-button>
        </ion-buttons>
    </ion-toolbar>
</ion-footer>